-- dimensional analysis for 3 dayswith agg AS (    select         metric_name,         month_start,        ARRAY[SUM(metric_array[1]),        SUM(metric_array[2]),        SUM(metric_array[3]),        SUM(metric_array[4])] AS summed_array    from array_metrics    group by metric_name, month_start)select     metric_name,    month_start + CAST(CAST(index - 1 AS TEXT) || ' day' AS INTERVAL),    elem as valueFROM agg CROSS JOIN UNNEST(agg.summed_array) with ORDINALITY as a(elem, index)